# Feedback Analyzer Platform

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—É —Å **API Gateway**, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å **Kafka** –∏ **ClickHouse**.  
–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `docker-compose` –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–Ω–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç)

- **API Gateway** ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ (Go, Chi). –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã (–≤–∫–ª—é—á–∞—è storage-service).
- **storage-service** ‚Äî —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü–∞–º–∏ ClickHouse, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä—É—á–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä—É—á–∫–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–ª—É—à–∞–µ—Ç Kafka-—Ç–æ–ø–∏–∫ —Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º–∏ –æ—Ç–∑—ã–≤–∞–º–∏.
- **ClickHouse** ‚Äî –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –°–£–ë–î (—Ö—Ä–∞–Ω–∏—Ç processed_data).
- **Kafka + Zookeeper** ‚Äî –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–æ–±—ã—Ç–∏—è–º–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏.
- **Kafdrop** ‚Äî –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Kafka.

## üöÄ –ó–∞–ø—É—Å–∫

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

   ```bash
   git clone  https://github.com/Segun228/gazprom_feedback_analyzer_man
   cd gazprom_feedback_analyzer_man
   ```

1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å `.env.example`

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã:

    ```bash
    docker-compose up --build
    ```

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –ø–æ–¥–Ω—è–ª–æ—Å—å:

   - API Gateway: [http://localhost:3000]
   - storage-service: [http://localhost:3001]
   - ClickHouse (HTTP): [http://localhost:8123]
   - Kafka (–ª–æ–∫–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø): [localhost:29092]
   - Kafdrop: [http://localhost:19000]

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```markdown
.
‚îú‚îÄ‚îÄ api-gateway/        # –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ API Gateway (Go)
‚îÇ   ‚îú‚îÄ‚îÄ config.yaml     # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ storage-service/    # —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å ClickHouse, Kafka –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.yaml     # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ docker-compose.yml  # —Å–µ—Ä–≤–∏—Å—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
‚îî‚îÄ‚îÄ README.md           # –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

| –ü–æ–ª–µ      | –§–æ—Ä–º–∞—Ç        | –û–ø–∏—Å–∞–Ω–∏–µ                          |
| --------- | ------------- | --------------------------------- |
| id        | UInt64        | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä          |
| text      | String        | –¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞                      |
| date      | DateTime      | –î–∞—Ç–∞ –æ—Ç–∑—ã–≤–∞                       |
| sentiment | Int8          | –û—Ü–µ–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è: -1, 0 –∏–ª–∏ 1    |
| tags      | Array(String) | –ú–∞—Å—Å–∏–≤ —Ç–µ–≥–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –æ—Ç–∑—ã–≤–æ–º |

## üåê –ü–æ—Ä—Ç—ã

| –°–µ—Ä–≤–∏—Å      | –ó–∞–Ω–∏–º–∞–µ–º—ã–π(-—ã–µ) –ø–æ—Ä—Ç(-—ã) | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                          |
| ----------- | ------------------------ | ----------------------------------- |
| API Gateway | `3000`                   | HTTP API                            |
| API Gateway | `3001`                   | HTTP API storage-service            |
| ClickHouse  | `8123`                   | HTTP –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (REST/SQL)           |
|             | `9000`                   | TCP –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (native client)       |
|             | `9009`                   | –ü—Ä–æ—Ç–æ–∫–æ–ª –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (optional)  |
| Zookeeper   | `2181`                   | –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è              |
| Kafka       | `9092`                   | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã) |
|             | `29092`                  | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å —Ö–æ—Å—Ç–∞ (localhost)     |
| Kafdrop     | `19000`                  | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è Kafka             |

## üõ†Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

- ClickHouse CLI:

```bash
   docker exec -it clickhouse clickhouse-client -u user --password password
```

- Health check (—á–µ—Ä–µ–∑ gateway):

```bash
   curl -v http://localhost:3000/storage/health
```

- –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ storage-service:

```bash
   docker logs -f storage-service
```

- –õ–æ–≥–∏ API Gateway:

```bash
   docker logs -f api-gateway
```

- –°–ø–∏—Å–æ–∫ —Ç–æ–ø–∏–∫–æ–≤ Kafka:

```bash
   docker exec -it kafka kafka-topics --bootstrap-server localhost:9092 --list
```
